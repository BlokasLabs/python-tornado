Description: fix CVE-2012-2374
Applied-Upstream: 2.2.1
Origin: https://github.com/facebook/tornado/commit/1ae91f6d58e6257e0ab49d295d8741ce1727bdb7
Author: Julian Taylor <jtaylor@ubuntu.com>
--- a/tornado/web.py
+++ b/tornado/web.py
@@ -258,7 +258,7 @@
         # If \n is allowed into the header, it is possible to inject
         # additional headers or split the request. Also cap length to
         # prevent obviously erroneous values.
-        if len(value) > 4000 or re.match(b(r"[\x00-\x1f]"), value):
+        if len(value) > 4000 or re.search(b(r"[\x00-\x1f]"), value):
             raise ValueError("Unsafe header value %r", value)
         return value
 
